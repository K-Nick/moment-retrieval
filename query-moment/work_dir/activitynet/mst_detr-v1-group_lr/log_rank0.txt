[2022-12-20 16:49:44](root:57)INFO [('KN_GROUP_LR', '1')]
[2022-12-20 16:49:44](root:59)INFO {'paths': {'root_dir': '/export/home2/kningtg/WORKSPACE/moment-retrieval/query-moment', 'data_dir': '/export/home2/kningtg/WORKSPACE/moment-retrieval/data-bin/raw', 'cache_dir': '/export/home2/kningtg/WORKSPACE/moment-retrieval/data-bin/cache', 'work_dir': '${paths.root_dir}/work_dir/${data.dataset}/${flags.exp}'}, 'flags': {'debug': False, 'ddp': False, 'amp': False, 'train': True, 'wandb': False, 'seed': 3147, 'exp': 'mst_detr-v1-group_lr'}, 'data': {'datapipe': 'mst_detr', 'dataset': 'activitynet', 'dataset_dir': '${paths.data_dir}/${data.dataset}', 'max_len_video': 512, 'target_stride': 4, 'word_mask_rate': 0.15, 'vid_hdf5': 'i3d.hdf5', 'vid_hdf5_key_template': '{video_id}'}, 'eval': {'ms': [1, 5], 'ns': [0.3, 0.5, 0.7], 'best_monitor': 'R1@IoU=0.7', 'is_best': 'max'}, 'train': {'num_workers': 8, 'num_epochs': 100, 'eval_epoch_interval': 1, 'batch_size': 32, 'optimizer': {'params': None, 'lr': 0.0001, 'betas': [0.9, 0.999], 'weight_decay': 0.0001, '_target_': <class 'torch.optim.adamw.AdamW'>}, 'clip_grad': 10.0, 'lr_scheduler': {'optimizer': None, 'factor': 0.5, 'patience': 5, 'verbose': True, '_target_': <class 'torch.optim.lr_scheduler.ReduceLROnPlateau'>}, 'val_interval': 1.0, 'print_interval': 0.2}, 'model_cfg': {'d_model': 512, 'ff_dim': 512, 'nhead': 16, 'num_layers_enc': 4, 'num_layers_dec': 3, 'sr_ratio_lvls': [4, 4, 2, 1], 'use_patch_merge': [True, False, True, True], 'dropout': 0.1, 'w_iou_loss': 30.0, 'w_l1_loss': 10.0, 'w_mask_loss': 0.5, 'w_enc_aux_loss': 1.0, 'w_dec_aux_loss': 1.0, 'focal_alpha': 0.1, 'sigma_s': 0.21, 'sigma_m': 0.25, 'topk': 1}, 'model': {'backbone': {'backbone': {'d_model_in': '${model_cfg.d_model}', 'd_model_lvls': {'s': '[${model_cfg.d_model}] * ${model_cfg.num_layers_enc}', '_target_': <function eval_str_impl at 0x15544b975d80>}, 'num_head_lvls': {'s': '[${model_cfg.nhead}] * ${model_cfg.num_layers_enc}', '_target_': <function eval_str_impl at 0x15544b975d80>}, 'ff_dim_lvls': {'s': '[${model_cfg.d_model}] * ${model_cfg.num_layers_enc}', '_target_': <function eval_str_impl at 0x15544b975d80>}, 'input_vid_dim': 1024, 'input_txt_dim': 300, 'max_vid_len': 512, 'max_txt_len': 100, 'sr_ratio_lvls': '${model_cfg.sr_ratio_lvls}', 'use_patch_merge': '${model_cfg.use_patch_merge}', '_target_': <class 'models.backbone.segformerx.SegFormerX'>}, 'output_layer': [0, 2, 3], 'intermediate_hidden_size': ['${model_cfg.d_model}', '${model_cfg.d_model}', '${model_cfg.d_model}'], 'fpn_hidden_size': '${model_cfg.d_model}', '_target_': <class 'models.backbone.segformerx.SegFormerXFPN'>}, 'head': {'d_model': '${model_cfg.d_model}', 'nhead': '${model_cfg.nhead}', 'ff_dim': '${model_cfg.ff_dim}', 'num_query': 100, 'num_layers': '${model_cfg.num_layers_dec}', 'num_scales': 3, 'pooler_resolution': 32, '_target_': <class 'models.ms_temporal_detr.ms_temporal_detr.QueryBasedDecoder'>}, 'model_cfg': '${model_cfg}', '_target_': <class 'models.ms_temporal_detr.ms_temporal_detr.MultiScaleTemporalDetr'>}}
[2022-12-20 16:49:45](torchtext.vocab.vectors:169)INFO Loading vectors from /export/home2/kningtg/WORKSPACE/moment-retrieval/data-bin/cache/.glove/glove.6B.300d.txt.pt
[2022-12-20 16:49:46](torchtext.vocab.vectors:169)INFO Loading vectors from /export/home2/kningtg/WORKSPACE/moment-retrieval/data-bin/cache/.glove/glove.6B.300d.txt.pt
[2022-12-20 16:49:47](torchtext.vocab.vectors:169)INFO Loading vectors from /export/home2/kningtg/WORKSPACE/moment-retrieval/data-bin/cache/.glove/glove.6B.300d.txt.pt
[2022-12-20 16:49:50](root:141)INFO ==============START TRAINING=============
[2022-12-20 16:50:42](root:198)INFO Train Epoch   0 [234/1170]	loss 2.823918	l1_loss 0.2720	iou_loss 0.0035	mask_loss 0.6751	enc_aux_loss 0.1212	dec_aux_loss 7.9729	grad_norm 0.5252	lr [0.0001, 3e-05]	batch_eta 0.2094s	mem 7011MB	
[2022-12-20 16:51:32](root:198)INFO Train Epoch   0 [468/1170]	loss 2.800266	l1_loss 0.2721	iou_loss 0.0027	mask_loss 0.6639	enc_aux_loss 0.1206	dec_aux_loss 8.0285	grad_norm 0.3669	lr [0.0001, 3e-05]	batch_eta 0.2019s	mem 7011MB	
[2022-12-20 16:52:22](root:198)INFO Train Epoch   0 [702/1170]	loss 2.793170	l1_loss 0.2715	iou_loss 0.0026	mask_loss 0.6843	enc_aux_loss 0.1238	dec_aux_loss 8.2850	grad_norm 0.0684	lr [0.0001, 3e-05]	batch_eta 0.2020s	mem 7062MB	
[2022-12-20 16:53:11](root:198)INFO Train Epoch   0 [936/1170]	loss 2.806977	l1_loss 0.2737	iou_loss 0.0023	mask_loss 0.6777	enc_aux_loss 0.1220	dec_aux_loss 7.9506	grad_norm 0.1761	lr [0.0001, 3e-05]	batch_eta 0.2017s	mem 7062MB	
[2022-12-20 16:55:38](root:155)INFO Evaluated Val	R1@IoU=0.3 0.0000	R1@IoU=0.5 0.0000	R1@IoU=0.7 0.0000	R5@IoU=0.3 0.0057	R5@IoU=0.5 0.0000	R5@IoU=0.7 0.0000	loss 2.8642	eta 97.3300s
